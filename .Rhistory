ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
View(cat_questions)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
title4 = str_to_sentence(title3),
title5 = str_trim(title4),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
url_gs <- 'https://docs.google.com/spreadsheets/d/15SY9gpr5ELo0dLRYZNjqzNzOKbF8JYtkI42eBIZDe68/edit#gid=597634711'
#Impact ========================================================================
raw_impact <- read_sheet(url_gs, 'impact_path')
View(raw_impact)
cat_impact <- raw_impact %>%
select(value = impact_code,
title = Impact) %>%
filter(!is.na(value))
export(cat_impact,'questionnaires/categories/impacts.xlsx', sheetName = "Categories", overwrite = T)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
title4 = str_to_sentence(title3),
title5 = str_trim(title4),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title4),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title4),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title3),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
export(cat_questions,'questionnaires/categories/impactsyesno.xlsx', sheetName = "Categories", overwrite = T)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title3),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
export(cat_questions,'questionnaires/categories/impactsyesno.xlsx', sheetName = "Categories", overwrite = T)
#Impact ========================================================================
raw_impact <- read_sheet(url_gs, 'impact_path')
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title3),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
export(cat_questions,'questionnaires/categories/impactsyesno.xlsx', sheetName = "Categories", overwrite = T)
assignment <- import("data/2.sample/cps_sample.csv") %>%
filter(tester) %>%
select(country = country_id,
counterpart = cp_id) %>%
mutate(`_quantity` = -1,
`_responsible` = "andres_int",
`_webmode` = 1,
cp_hidden = counterpart
)
export(assignment,'questionnaires/assignments/testers.txt' )
View(assignment)
export(assignment,'questionnaires/assignments/testers.txt' )
library(dplyr)
library(janitor)
s <- rio::import('data/2.sample/cps_sample.csv')
links <- read.delim('data/3.Assignments/interviews.tab')
clean_links <- links %>%
select(url = assignment__link,
cp_id = cp_hidden
) %>%
left_join(select(s, Name, Country_name, email, region, director, cp_id)) %>%
relocate(Name, email,Country_name, region, director) %>%
select(-cp_id)
export(clean_links, 'data/4.campaigns/testers.csv')
library(googlesheets4)
library(dplyr)
library(rio)
library(tidyr)
library(stringr)
url_gs <- 'https://docs.google.com/spreadsheets/d/15SY9gpr5ELo0dLRYZNjqzNzOKbF8JYtkI42eBIZDe68/edit#gid=597634711'
#Impact ========================================================================
raw_impact <- read_sheet(url_gs, 'impact_path')
cat_impact <- raw_impact %>%
select(value = impact_code,
title = Impact) %>%
filter(!is.na(value))
export(cat_impact,'questionnaires/categories/impacts.xlsx', sheetName = "Categories", overwrite = T)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title3),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
export(cat_questions,'questionnaires/categories/impactsyesno.xlsx', sheetName = "Categories", overwrite = T)
View(cat_questions)
library(googlesheets4)
library(dplyr)
library(rio)
library(tidyr)
library(stringr)
url_gs <- 'https://docs.google.com/spreadsheets/d/15SY9gpr5ELo0dLRYZNjqzNzOKbF8JYtkI42eBIZDe68/edit#gid=597634711'
#Impact ========================================================================
raw_impact <- read_sheet(url_gs, 'impact_path')
cat_impact <- raw_impact %>%
select(value = impact_code,
title = Impact) %>%
filter(!is.na(value))
export(cat_impact,'questionnaires/categories/impacts.xlsx', sheetName = "Categories", overwrite = T)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title3),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
View(raw_impact)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title3),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
View(cat_questions)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title')
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`))
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title3),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`))
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title')
cat_questions <- raw_impact %>%
filter(!is.na(impact_code),
!is.na(`Impact Q1`)) %>%
select(impact_code,
starts_with("Impact Q")
) %>%
pivot_longer(-impact_code,
values_to = 'title') %>%
select(-name) %>%
filter(!is.na(title),
title != "AS ABOVE ALL CELLS"
) %>%
mutate(title2 = str_remove(title, "To the best of your knowledge, "),
title3 = str_remove_all(title2, "has any |have|\\?|has the |are the"),
#title4 = str_to_sentence(title3),
title5 = str_trim(title3),
title6 = str_replace(title5, "Iaea", "IAEA")) %>%
select(impact_code, title = title6) %>%
group_by(impact_code) %>%
mutate(value = paste0(impact_code, row_number())) %>%
ungroup() %>%
select(value, title) %>%
mutate(title = str_replace_all(title, "iaea", "IAEA")) %>%
filter(
#this is the same as 114. Thus, it should 114 should be enabled when impact 13 is selected
!(value== "131" &
title == "Reduced post-harvest losses in food production with the application of irradiation technology")
)
export(cat_questions,'questionnaires/categories/impactsyesno.xlsx', sheetName = "Categories", overwrite = T)
assignment <- import("data/2.sample/cps_sample.csv") %>%
filter(tester) %>%
select(country = country_id,
counterpart = cp_id) %>%
mutate(`_quantity` = -1,
`_responsible` = "andres_int",
`_webmode` = 1,
cp_hidden = counterpart
)
#create assignments
library(dplyr)
assignment <- import("data/2.sample/cps_sample.csv") %>%
filter(tester) %>%
select(country = country_id,
counterpart = cp_id) %>%
mutate(`_quantity` = -1,
`_responsible` = "andres_int",
`_webmode` = 1,
cp_hidden = counterpart
)
library(rio)
assignment <- import("data/2.sample/cps_sample.csv") %>%
filter(tester) %>%
select(country = country_id,
counterpart = cp_id) %>%
mutate(`_quantity` = -1,
`_responsible` = "andres_int",
`_webmode` = 1,
cp_hidden = counterpart
)
View(assignment)
export(assignment,'questionnaires/assignments/testers.txt' )
library(dplyr)
library(janitor)
s <- rio::import('data/2.sample/cps_sample.csv')
links <- read.delim('data/3.Assignments/interviews.tab')
clean_links <- links %>%
select(url = assignment__link,
cp_id = cp_hidden
) %>%
left_join(select(s, Name, Country_name, email, region, director, cp_id)) %>%
relocate(Name, email,Country_name, region, director) %>%
select(-cp_id)
export(clean_links, 'data/4.campaigns/testers.csv')
clean_links <- links %>%
select(url = assignment__link,
cp_id = cp_hidden
) %>%
left_join(select(s, Name, Country_name, email, region, director, cp_id)) %>%
relocate(Name, email,Country_name, region, director) %>%
select(-cp_id) %>%
rename_all(function(x)paste("cpt_", x))
View(clean_links)
export(clean_links, 'data/4.campaigns/testers.csv')
export(clean_links, 'data/4.campaigns/testers.csv')
clean_links <- links %>%
select(url = assignment__link,
cp_id = cp_hidden
) %>%
left_join(select(s, Name, Country_name, email, region, director, cp_id)) %>%
relocate(Name, email,Country_name, region, director) %>%
select(-cp_id)
export(clean_links, 'data/4.campaigns/testers.csv')
clean_links <- links %>%
select(url = assignment__link,
cp_id = cp_hidden
) %>%
left_join(select(s, Name, Country_name, email, region, director, cp_id)) %>%
relocate(Name, email,Country_name, region, director) %>%
select(-cp_id) %>%
rename(Country = Country_name)
export(clean_links, 'data/4.campaigns/testers.csv')
library(xlsx)
wb = xlsx::loadWorkbook('questionnaires/translations/CPS.xlsx')
View(wb)
library(readxl)
template_file <- 'questionnaires/translations/CPS.xlsx'
excel_sheets(template_file)
sheets <- excel_sheets(template_file)
wb[sheets[1]]
names(wb)
googlesheets4::write_sheet?
googlesheets4::write_sheet()?
googlesheets4::write_sheet?
