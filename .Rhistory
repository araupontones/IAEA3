theme_main()
}
t %>%
ggLikertbarsRelevance(titulo = 't',
subtitulo = 'y')
ggLikertbarsRelevance <- function(.data,
titulo,
subtitulo){
categories <-levels(.data$categories)
.data %>%
ggplot(aes(x = perc,
y = reorder(FOA_new,sort),
fill = categories)) +
geom_col(width = .8) +
geom_vline(xintercept = .5,
linetype = 'dashed') +
labs(title = titulo,
subtitle = subtitulo)+
scale_y_discrete(labels = label_wrap_gen(25)) +
scale_x_continuous(expand = c(0,0),
labels = function(x)percent(x)) +
scale_fill_brewer(breaks = rev(categories),
labels = rev(categories)) +
theme_main()
}
t %>%
ggLikertbarsRelevance(titulo = 't',
subtitulo = 'y')
foas <- degree_max %>%
filter(theme == 'FOOD and AGRICULTURE') %>%
group_perc(c('FOA_new'),
perc_of = 'degree_contribution',
sort_cat = c("Regional reference","Master stage")
)
foas %>%
ggLikertbarsRelevance(titulo = 't',
subtitulo = 'y')
foas_region  <- degree_max %>%
filter(theme == 'FOOD and AGRICULTURE') %>%
group_perc(c('region','FOA_new'),
perc_of = 'degree_contribution',
sort_cat = c("Regional reference","Master stage")
)
foas_region %>%
ggLikertbarsRelevance(titulo = 't',
subtitulo = 'y') +
facet_wrap(~ region)
gmdacr::load_functions('functions')
#relevance by foa ============================================================
names(lkp_themes)
find_in_lkp(lkp_themes,'dirname',when = 'theme', equals = 'FOOD and AGRICULTURE')
find_in_lkp(lkp_themes,fetch = 'dirname',when = 'theme', equals = 'FOOD and AGRICULTURE')
View(lkp_themes)
find_in_lkp(lkp_themes,fetch = 'dirname',when = 'theme', equals = 'Food and Agriculture')
exdir_theme <-find_in_lkp(lkp_themes,fetch = 'dirname',when = 'theme', equals = 'Food and Agriculture')
foas <- degree_max %>%
filter(theme == 'FOOD and AGRICULTURE') %>%
group_perc(c('FOA_new'),
perc_of = 'degree_contribution',
sort_cat = c("Regional reference","Master stage")
)
foas <- degree_max %>%
filter(theme == 'FOOD and AGRICULTURE') %>%
group_perc(c('FOA_new'),
perc_of = 'degree_contribution',
sort_cat = c("Regional reference","Master stage")
) %>%
ggLikertbarsRelevance(titulo = 't',
subtitulo = 'y')
foas
foas <- degree_max %>%
filter(theme == 'FOOD and AGRICULTURE') %>%
group_perc(c('FOA_new'),
perc_of = 'degree_contribution',
sort_cat = c("Regional reference","Master stage")
) %>%
ggLikertbarsRelevance(titulo = 'Degree to which the TCP has contributed in achieving results.',
subtitulo = 'Between FOAs of Food and Agriculutre')
foas
foas_region  <- degree_max %>%
filter(theme == 'FOOD and AGRICULTURE') %>%
group_perc(c('region','FOA_new'),
perc_of = 'degree_contribution',
sort_cat = c("Regional reference","Master stage")
) %>%
ggLikertbarsRelevance(titulo = 'Degree to which the TCP has contributed in achieving results.',
subtitulo = 'Between FOAs of Food and Agriculutre.') +
facet_wrap(~ region)
ggsave(glue('{exdir}/{exdir_theme}/bewteen_foas.png', foas))
ggsave(glue('{exdir}/{exdir_theme}/bewteen_foas.png'), foas))
ggsave(glue('{exdir}/{exdir_theme}/bewteen_foas.png'), foas)
ggsave(glue('{exdir}/{exdir_theme}/bewteen_foas.png'), foas)
exit <- file.path(exdir, exdir_theme)
dir.exists(exit)
if(!dir.exists(exit)){
dir.create(exit)
}
ggsave(glue('{exdir}/{exdir_theme}/bewteen_foas.png'), foas)
ggsave(glue('{exdir}/{exdir_theme}/bewteen_foas_region.png'), foas_region)
View(degree_increase)
#increase ========================================================================
data_increase %>% filter(theme == 'FOOD and AGRICULTURE' )
#increase ========================================================================
data_increase %>% filter(theme == 'FOOD and AGRICULTURE' )
#increase ========================================================================
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' )
#increase ========================================================================
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_by(FOA_new) %>%
summarise(better = mean(better))
#increase ========================================================================
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_by(FOA_new) %>%
summarise(better = mean(better), .groups = 'drop') %>%
arrange(better)
#increase ========================================================================
group_better <- function(.data, by){
.data %>%
group_by(FOA_new) %>%
summarise(better = mean(better), .groups = 'drop') %>%
arrange(better)
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new")
#increase ========================================================================
group_better <- function(.data, by){
.data %>%
group_by_at(FOA_new) %>%
summarise(better = mean(better), .groups = 'drop') %>%
arrange(better)
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new")
#increase ========================================================================
group_better <- function(.data, by){
.data %>%
group_by_at(by) %>%
summarise(better = mean(better), .groups = 'drop') %>%
arrange(better)
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new")
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = c("FOA_new", 'region'))
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = FOA_new)
)+
geom_col()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better)
))+
geom_col()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better)
))+
geom_col(fill = blue)
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better)
))+
geom_col(fill = blue) +
scale_x_continuous(labels = percent)
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better)
))+
geom_col(fill = blue) +
scale_x_continuous(labels = percent,
limits = c(0,1))
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better)
))+
geom_col(fill = blue) +
scale_x_continuous(labels = percent,
limits = c(0,1)
) +
scale_y_datetime(label_wrap(25))
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better)
))+
geom_col(fill = blue) +
scale_x_continuous(labels = percent,
limits = c(0,1)
) +
scale_y_discrete(label_wrap(25))
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better)
))+
geom_col(fill = blue) +
scale_x_continuous(labels = percent,
limits = c(0,1)
) +
scale_y_discrete(label = label_wrap(25))
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better)
))+
geom_col(fill = blue) +
scale_x_continuous(labels = percent,
limits = c(0,1)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better)
))+
geom_col(fill = blue,
width = .8) +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better)
))+
geom_col(fill = blue,
width = .8) +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better)
))+
geom_col(fill = blue,
width = .8) +
geom_text() +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better,0)
))+
geom_col(fill = blue,
width = .8) +
geom_text() +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better,1)
))+
geom_col(fill = blue,
width = .8) +
geom_text() +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better,1)
))+
geom_col(fill = blue,
width = .8) +
geom_text(hjust = 1) +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better,1)
))+
geom_col(fill = blue,
width = .8) +
geom_text(hjust = 1,
color = 'white') +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better,1)
))+
geom_col(fill = blue,
width = .8) +
geom_text(hjust = 1,
color = 'white',
family = "Open Sans") +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better,1)
))+
geom_col(fill = blue,
width = .8) +
geom_text(hjust = 1,
color = 'white',
family = "Open Sans") +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better,1)
))+
geom_col(fill = blue,
width = .8) +
geom_text(hjust = 1,
color = 'white',
family = "Open Sans") +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
labs(title = "Areas where the TCP contributed to increase development stage")
plot_better <- function(.data){
.data %>%
ggplot(
aes(x = better,
y = reorder(FOA_new, better),
label = percent(better,1)
))+
geom_col(fill = blue,
width = .8) +
geom_text(hjust = 1,
color = 'white',
family = "Open Sans") +
scale_x_continuous(labels = percent,
limits = c(0,1),
expand = c(0,0)
) +
scale_y_discrete(label = label_wrap(25)) +
labs(title = "Areas where the TCP contributed to increase development stage") +
theme_main()
}
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = c("FOA_new", 'region')) %>%
plot_better() +
facet_wrap(~region)
degree_increase %>% filter(theme == 'FOOD and AGRICULTURE' ) %>%
group_better(by = "FOA_new") %>%
plot_better()
ggsave(glue('{exdir}/{exdir_theme}/stages_increase.png'))
ggsave(glue('{exdir}/{exdir_theme}/stages_increase_region.png'))
foas <- degree_max %>%
filter(theme == 'FOOD and AGRICULTURE') %>%
group_perc(c('FOA_new'),
perc_of = 'degree_contribution',
sort_cat = c("Regional reference","Master stage")
) %>%
ggLikertbarsRelevance(titulo = 'Degree to which the TCP has contributed in achieving results.',
subtitulo = 'Between FOAs of Food and Agriculutre.')
foas
foas_region  <- degree_max %>%
filter(theme == 'FOOD and AGRICULTURE') %>%
group_perc(c('region','FOA_new'),
perc_of = 'degree_contribution',
sort_cat = c("Regional reference","Master stage")
) %>%
ggLikertbarsRelevance(titulo = 'Degree to which the TCP has contributed in achieving results.',
subtitulo = 'Between FOAs of Food and Agriculutre.') +
facet_wrap(~ region)
ggsave(glue('{exdir}/{exdir_theme}/between_foas.png'), foas)
ggsave(glue('{exdir}/{exdir_theme}/between_foas_region.png'), foas_region)
data_theme <- degree_max %>% group_relevance(c('theme'))
data_theme %>%
plot_relevance()
